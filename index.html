<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>予想 vs 実際経費 割合ツール</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="header">
    <h1>予想 vs 実際経費 割合ツール</h1>
    <nav class="nav">
      <a href="index.html" class="nav-link active">計算画面</a>
      <a href="history.html" class="nav-link">過去データ</a>
      <a href="test.html" class="nav-link">テスト画面</a>
    </nav>
  </header>

  <main class="main">
    <!-- 計算の概要 -->
    <section class="section overview">
      <h2>計算の概要</h2>
      <div id="calcOverview" class="overview-content">
        <p class="overview-item" id="overview-daily"></p>
        <p class="overview-item" id="overview-voice"></p>
        <p class="overview-item" id="overview-coaching"></p>
        <p class="overview-item overview-total">総額: 1人あたり合計 × 在籍生徒数</p>
      </div>
    </section>

    <!-- 共通入力 -->
    <section class="section">
      <h2>共通入力</h2>
      <div id="validationWrap" class="validation-wrap hidden"></div>
      <div class="input-group">
        <label>
          対象月
          <input type="month" id="targetMonth" value="">
        </label>
        <label>
          在籍生徒数
          <input type="number" id="students" min="1" value="100" placeholder="必須">
        </label>
        <label>
          営業日数
          <input type="number" id="businessDays" min="1" max="31" value="30">
        </label>
      </div>
      <div class="save-area">
        <button type="button" id="saveBtn" class="btn-save">この月のデータを保存</button>
        <button type="button" id="exportCsvBtn" class="btn-export">CSVダウンロード</button>
        <button type="button" onclick="window.print()" class="btn-print">印刷</button>
        <span id="saveMessage" class="save-message"></span>
      </div>
    </section>

    <!-- 各チームの入力 -->
    <section class="section">
      <h2>チーム別入力</h2>
      <p class="section-desc"><strong>予想</strong>：単価・対応時間・提出率から計算。<strong>実際</strong>：支払った報酬（円）を入力すると1人あたりに逆算します。「予想を実際にコピー」で予想合計を実際支払額に反映できます。</p>
      <div class="copy-buttons">
        <button type="button" id="copyExpectedToActual" class="btn-copy">予想 → 実際にコピー</button>
      </div>
      <div class="teams-grid">
        <div class="team-card">
          <h3>日報チーム</h3>
          <p class="team-desc">予想: 時給 × 対応分数/日 × 営業日数 × 提出率</p>
          <div class="ea-grid">
            <div class="ea-row ea-header">
              <span class="ea-label"></span>
              <span class="ea-col ea-col-expected">予想（計算）</span>
              <span class="ea-col ea-col-actual">実際（支払額から逆算）</span>
            </div>
            <div class="ea-row ea-row-actual-span">
              <span class="ea-label">単価（円/時）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="daily-price" min="0" value="2282"></span>
              <span class="ea-col ea-col-actual ea-col-actual-payment">
                <label class="actual-payment-label">支払額（円）</label>
                <input type="number" id="actual-daily-payment" min="0" value="0" placeholder="実際に支払った金額">
              </span>
            </div>
            <div class="ea-row">
              <span class="ea-label">対応時間（分/人/日）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="daily-mins" min="0" value="5"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
            <div class="ea-row">
              <span class="ea-label">提出率（%）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="daily-rate" min="0" max="100" value="100"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
          </div>
        </div>
        <div class="team-card">
          <h3>音声チーム</h3>
          <p class="team-desc">予想: 時給 × 対応分数/日 × 営業日数 × 提出率</p>
          <div class="ea-grid">
            <div class="ea-row ea-header">
              <span class="ea-label"></span>
              <span class="ea-col ea-col-expected">予想（計算）</span>
              <span class="ea-col ea-col-actual">実際（支払額から逆算）</span>
            </div>
            <div class="ea-row ea-row-actual-span">
              <span class="ea-label">単価（円/時）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="voice-price" min="0" value="1209"></span>
              <span class="ea-col ea-col-actual ea-col-actual-payment">
                <label class="actual-payment-label">支払額（円）</label>
                <input type="number" id="actual-voice-payment" min="0" value="0" placeholder="実際に支払った金額">
              </span>
            </div>
            <div class="ea-row">
              <span class="ea-label">対応時間（分/人/日）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="voice-mins" min="0" value="4"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
            <div class="ea-row">
              <span class="ea-label">提出率（%）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="voice-rate" min="0" max="100" value="100"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
          </div>
        </div>
        <div class="team-card">
          <h3>コーチングチーム</h3>
          <p class="team-desc">予想: 単価 × 回数/月 × 提出率</p>
          <div class="ea-grid">
            <div class="ea-row ea-header">
              <span class="ea-label"></span>
              <span class="ea-col ea-col-expected">予想（計算）</span>
              <span class="ea-col ea-col-actual">実際（支払額から逆算）</span>
            </div>
            <div class="ea-row ea-row-actual-span">
              <span class="ea-label">単価（円/回）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="coaching-price" min="0" value="1750"></span>
              <span class="ea-col ea-col-actual ea-col-actual-payment">
                <label class="actual-payment-label">支払額（円）</label>
                <input type="number" id="actual-coaching-payment" min="0" value="0" placeholder="実際に支払った金額">
              </span>
            </div>
            <div class="ea-row">
              <span class="ea-label">対応回数（回/人/月）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="coaching-count" min="0" value="4"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
            <div class="ea-row">
              <span class="ea-label">提出率（%）</span>
              <span class="ea-col ea-col-expected"><input type="number" id="coaching-rate" min="0" max="100" value="100"></span>
              <span class="ea-col ea-col-actual ea-col-actual-empty"></span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 計算結果 -->
    <section class="section results">
      <h2>計算結果</h2>
      <div class="results-grid">
        <div class="result-item">
          <span class="result-label">日報チーム</span>
          <span class="result-value">予想 <span id="result-daily-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-daily-total">0</span>円</span>
        </div>
        <div class="result-item actual-row">
          <span class="result-label"></span>
          <span class="result-value">実際 <span id="result-act-daily-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-act-daily-total">0</span>円</span>
        </div>
        <div class="result-item">
          <span class="result-label">音声チーム</span>
          <span class="result-value">予想 <span id="result-voice-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-voice-total">0</span>円</span>
        </div>
        <div class="result-item actual-row">
          <span class="result-label"></span>
          <span class="result-value">実際 <span id="result-act-voice-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-act-voice-total">0</span>円</span>
        </div>
        <div class="result-item">
          <span class="result-label">コーチングチーム</span>
          <span class="result-value">予想 <span id="result-coaching-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-coaching-total">0</span>円</span>
        </div>
        <div class="result-item actual-row">
          <span class="result-label"></span>
          <span class="result-value">実際 <span id="result-act-coaching-per">0</span>円/人</span>
          <span class="result-total">合計 <span id="result-act-coaching-total">0</span>円</span>
        </div>
      </div>
      <div class="result-summary">
        <p class="per-student">生徒1人あたり合計（予想）: <strong id="result-per-student">0</strong>円</p>
        <p class="total-cost">予想人件費: <strong id="result-total">0</strong>円</p>
      </div>
      <div class="actual-summary">
        <p class="per-student">生徒1人あたり合計（実際）: <strong id="actual-per-student">0</strong>円</p>
        <p class="total-cost">実際人件費: <strong id="actual-total">0</strong>円</p>
      </div>
    </section>

    <!-- 割合・逆算結果 -->
    <section class="section ratio-section">
      <h2>割合・逆算結果</h2>
      <div class="ratio-results">
        <div class="ratio-block">
          <h3>チーム別 予想 vs 実際</h3>
          <div class="ratio-table">
            <div class="ratio-row header">
              <span>チーム</span>
              <span>予想</span>
              <span>実際</span>
              <span>1人あたり（予想）</span>
              <span>1人あたり（実際）</span>
              <span>割合</span>
            </div>
            <div class="ratio-row">
              <span>日報</span>
              <span id="exp-daily">0</span>
              <span id="act-daily">0</span>
              <span id="exp-per-daily">-</span>
              <span id="act-per-daily">-</span>
              <span id="ratio-daily">-</span>
            </div>
            <div class="ratio-row">
              <span>音声</span>
              <span id="exp-voice">0</span>
              <span id="act-voice">0</span>
              <span id="exp-per-voice">-</span>
              <span id="act-per-voice">-</span>
              <span id="ratio-voice">-</span>
            </div>
            <div class="ratio-row">
              <span>コーチング</span>
              <span id="exp-coaching">0</span>
              <span id="act-coaching">0</span>
              <span id="exp-per-coaching">-</span>
              <span id="act-per-coaching">-</span>
              <span id="ratio-coaching">-</span>
            </div>
          </div>
        </div>
        <div class="ratio-block summary">
          <h3>全体</h3>
          <div class="ratio-results">
            <div class="ratio-item">
              <span class="ratio-label">割合</span>
              <span id="ratio-value" class="ratio-value">-</span>
              <span class="ratio-desc">（予想に対する実際の割合）</span>
            </div>
            <div class="ratio-item">
              <span class="ratio-label">差異</span>
              <span id="ratio-diff" class="ratio-diff">-</span>
            </div>
            <div class="ratio-item">
              <span class="ratio-label">判定</span>
              <span id="ratio-judge" class="ratio-judge">-</span>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script src="calculator.js"></script>
  <script src="app.js"></script>
</body>
</html>
